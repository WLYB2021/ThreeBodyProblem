# 三体问题Web应用开发文档

## 开发计划

### 第一阶段：基础框架搭建（已完成）
- [x] 创建项目目录结构
- [x] 使用Vite初始化Vue 3 + TypeScript项目
- [x] 安装Three.js等核心依赖
- [x] 配置项目构建文件
- [x] 实现100%视口占据的中心3D视图区域
- [x] 开发悬浮式UI组件框架
- [x] 优化UI设计为黑白极简风格（黑色主界面，白色组件）
- [x] 优化悬浮组件布局：调整按钮位置，修复边界问题，添加安全边距
- [x] 修复各种UI渲染问题和交互逻辑错误
- [x] 完成项目构建测试

### 第二阶段：功能增强（进行中）
- [x] 实现三体物理计算模块并进行性能优化
- [x] 开发Three.js渲染组件
- [x] 实现所有悬浮UI组件（控制面板、操作按钮组、信息面板）
- [x] 开发实时数据显示功能（FPS计数器）
- [x] 实现键盘快捷键支持（ESC、空格键、R键）
- [x] 实现物理参数控制面板
- [x] 移除坐标轴提示线，实现动态网格系统
- [ ] 添加预设场景系统
- [ ] 添加粒子渲染与轨迹绘制功能

### 第三阶段：优化与完善
- [ ] 性能优化（物理计算、渲染）
- [ ] 响应式设计完善，适配移动端
- [x] 添加动效与交互增强（按钮动画、面板滑入效果）
- [x] 为UI组件添加进入动画，实现按顺序依次出现的序列效果
- [x] 实现面板拖动功能
- [x] 优化摄像机控制（添加双击重置视角）
- [x] 修复暂停状态下无法更改视角的问题
- [ ] 单元测试与集成测试
- [x] 文档完善
- [x] GitHub Pages部署配置
- [ ] 用户体验优化
- [ ] 错误处理与边界情况优化

## 当前进度
| 任务 | 状态 | 负责人 | 完成日期 |
|------|------|--------|----------|
| 项目初始化 | 完成 | - | - |
| 依赖安装 | 完成 | - | - |
| 悬浮式布局系统 | 完成 | - | - |
| 交互系统基础框架 | 完成 | - | - |
| 代码优化与修复 | 完成 | - | - |
| 项目构建测试 | 完成 | - | - |
| 物理模拟 | 完成 | - | - |
| 物理参数控制面板 | 完成 | - | 右侧滑入面板 |
| 设置面板 | 完成 | - | 右侧滑入面板 |
| 预设场景系统 | 完成 | - | - |
| 粒子渲染与轨迹绘制 | 待开发 | - | - |
| 性能优化 | 待开发 | - | - |
| 响应式设计完善 | 待开发 | - | - |
| 单元测试与集成测试 | 待开发 | - | - |
| 用户体验优化 | 待开发 | - | - |
| 错误处理优化 | 待开发 | - | - |

## 项目概述
三体问题Web应用是一个基于WebGL的交互式三体系统模拟器，旨在通过直观的可视化方式展示三体系统的动态行为和混沌特性。本项目采用开源教育工具定位，面向对物理学、天文学感兴趣的学生、教育工作者和科普爱好者。采用了全新的悬浮式布局设计，提供沉浸式视觉体验，同时保持直观的交互方式。

## 技术栈选择
- **前端框架**：Vue 3 + TypeScript
- **构建工具**：Vite
- **3D渲染**：Three.js + WebGL 1.0
- **样式**：原生CSS
- **数据存储**：LocalStorage
- **物理计算**：自定义物理引擎（RK4数值积分）

## 项目结构
```
/
├── src/              # 源代码目录
│   ├── assets/           # 静态资源
│   ├── components/       # Vue组件
│   │   ├── ThreeCanvas.vue     # Three.js渲染组件
│   │   ├── FloatingControlPanel.vue    # 悬浮控制面板组件
│   │   ├── FloatingActionButtons.vue   # 悬浮操作按钮组
│   │   ├── FloatingInfoPanel.vue       # 悬浮信息面板组件
│   │   └── PresetSelector.vue          # 预设场景选择器
│   ├── hooks/            # Vue组合式函数
│   │   ├── useThree.ts         # Three.js初始化钩子
│   │   ├── usePhysics.ts       # 物理计算钩子
│   │   ├── useKeyboardShortcuts.ts     # 键盘快捷键钩子
│   │   └── useFloatingComponents.ts    # 悬浮组件管理钩子
│   ├── physics/          # 物理计算模块
│   │   ├── calculations.ts     # 基础物理计算
│   │   ├── integrators.ts      # 数值积分器
│   │   └── constants.ts        # 物理常数
│   ├── utils/            # 工具函数
│   │   ├── animationUtils.ts   # 动画工具函数
│   │   └── dragUtils.ts        # 拖动功能工具函数
│   ├── App.vue           # 根组件
│   ├── main.ts           # 入口文件
│   └── style.css         # 全局样式
├── DEVELOP.md        # 开发文档（位于项目根目录）
```

> 注意：DEVELOP.md 文档位于项目根目录，而非 src 子目录。

## 开发规范
- 代码遵循Vue 3 Composition API风格
- 命名规范：组件使用PascalCase，变量使用camelCase，常量使用SNAKE_CASE
- 每个组件需要添加TypeScript接口定义
- 关键算法需要添加注释说明
- 遵循ESLint和Prettier规范
- 悬浮组件设计需考虑可访问性，确保键盘可操作
- 所有交互元素需添加适当的ARIA属性
- 动画效果需设置适当的持续时间和缓动函数

## 已实现功能说明

### 1. 悬浮式布局系统
- 实现100%视口中心3D视图
- 所有UI元素采用悬浮式设计，使用绝对定位和z-index控制层级
- 实现半透明黑色背景，提升沉浸感

### 2. 交互组件实现
- **物理参数控制面板**：右侧滑入，包含时间步长、天体质量等参数调整
- **设置面板**：右侧滑入，包含预设场景选择和轨迹显示设置
- **悬浮信息面板**：显示状态和时间，支持鼠标拖动定位
- **悬浮按钮组**：右下角核心功能按钮组和左下角控制按钮组
- **FPS计数器**：显示实时帧率
- **提示信息**：顶部临时显示操作反馈

### 3. 交互体验优化
- **键盘快捷键**：ESC键（隐藏面板）、空格键（播放/暂停）、R键（重置）
- **摄像机控制增强**：双击canvas重置视角，修复暂停状态下视角控制
- **沉浸体验改进**：点击外部区域自动收起控制面板

### 4. 渲染控制
- Three.js渲染器与物理引擎分离
- 支持视角轨道控制，移除坐标轴提示线
- 实现动态网格系统，大小随视角自动调整
- 实时FPS显示和模拟时间统计

### 5. 界面优化
- 统一UI组件样式和视觉效果
- 调整UI布局，优化按钮位置
- 面板样式更新为深色主题设计
- 增强交互体验和视觉一致性

### 6. 动态效果实现
- 按钮点击动画反馈
- 面板滑入滑出平滑过渡
- 信息面板可拖动定位
- 鼠标悬停效果增强

## 注意事项
- 物理计算需要注意数值精度问题
- 渲染性能需要重点优化
- 确保在低性能设备上也能流畅运行
- 遵循响应式设计原则，适配不同屏幕尺寸
- 下一阶段重点：完善粒子渲染与轨迹绘制功能

## GitHub Pages部署指南

### 已完成配置

1. **修改Vite配置**：
   - 在`vite.config.ts`中添加`base: '/ThreeBodyProblem/'`配置，确保资源路径正确

2. **安装部署工具**：
   - 安装`gh-pages`包：`npm install --save-dev gh-pages`
   - 在`package.json`中添加部署脚本：`"deploy": "gh-pages -d dist"`

3. **构建与部署**：
   - 执行构建：`npm run build`
   - 执行部署：`npm run deploy`

### 访问地址

部署成功后，应用可通过以下地址访问：
- `https://[username].github.io/ThreeBodyProblem/`

### 后续维护

如需更新部署，只需重复以下步骤：
1. 运行`npm run build`重新构建项目
2. 运行`npm run deploy`发布更新

### 注意事项

- 确保所有资源使用相对路径引用
- GitHub Pages可能需要几分钟时间更新部署内容
- 如遇到404错误，检查base路径配置是否正确
